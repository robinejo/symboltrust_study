---
title: "Intervention in augmented reality"
subtitle: "Analysis script for a preregistration"
author: "Removed for anonymization"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  html_document:
    code_folding: hide
    highlight: haddock
    theme: flatly
    toc: yes
    toc_float: yes
---

```{r, include=FALSE}
knitr::opts_chunk$set(message=FALSE,
                      warning=FALSE,
                      cache.lazy=FALSE)
```

# Dependencies
Install these packages, if not already installed. Then load them.
```{r}
library(psych) # for the function describeBy
library(restriktor) # for the goric function
library(tidyverse)
library(dplyr)
library(ggplot2)
```

# get data
```{r}
data_processed <- read_csv("../../data/processed/data_processed.csv")
```

# Demographics
```{r}
gender <- data_processed |>
  count(gender)

mean_age <- mean(data_processed$age, na.rm = TRUE)


bedingung <- data_processed |>
  count(bedingung)

```

# Statistics

```{r}
data_processed$bedingung <- factor(data_processed$bedingung)  

# Inspect the data #
head(data_processed) # Look at first (6) rows of the data

# Compute Descriptive stats for each group(=Bedingung)
descrstat_sys_trust <- describeBy(data_processed$mean_sys_trust, data_processed$bedingung, mat = TRUE)
descrstat_symb_trust <- describeBy(data_processed$mean_symb_trust, data_processed$bedingung, mat = TRUE)

## Compute the GORIC ##
lm_fit_data_processed_sys_trust <-  lm(mean_sys_trust ~ bedingung-1, data = data_processed)
lm_fit_data_processed_symb_trust <-  lm(mean_symb_trust ~ bedingung-1, data = data_processed)

# Check the names used in model
names(coef(lm_fit_data_processed_sys_trust))
names(coef(lm_fit_data_processed_symb_trust))

# Hypotheses 

Hsys <- 'bedingung1 = bedingung2 = bedingung3 = bedingung4 = bedingung5'

Hsymb <- 'bedingung1 < bedingung2 & bedingung1 < bedingung3 &  bedingung1 < bedingung4 &  bedingung1 < bedingung5'

# Calculate GORIC values and weights

set.seed(123)

output_c_sys <- goric(lm_fit_data_processed_sys_trust, 
                  hypotheses = list(H_theory_sys = Hsys), comparison = "complement")
output_c_sys


output_c_symb <- goric(lm_fit_data_processed_symb_trust, 
                  hypotheses = list(H_theory_symb = Hsymb), comparison = "complement")
output_c_symb


```




```{r}

```

