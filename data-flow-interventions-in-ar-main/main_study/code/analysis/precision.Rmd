---
title: "Precision / sensitivity / power analysis"
author: "Removed for anonymization"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  html_document:
    code_folding: hide
    highlight: haddock
    theme: flatly
    toc: yes
    toc_float: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

See Abt et al. (2020; https://doi.org/10.1080/02640414.2020.1776002) on how to perform a power analysis to determine the width of a confidence interval around the effect size.

ROPE (region of practical equivalence) needs to be wider than CI width of effect size by a meaningful amount, e.g., 1.5x the width, to allow for the possibility of the HDI being inside the ROPE.

# Dependencies

```{r}
R.version
library(MBESS)
```

# Comparing two groups (t-tests)

For delta = standardized mean difference (Cohenâ€™s d) between two groups (delta = 0.5 low medium effect)
For conf.level = confidence interval 
Return value = total width (half either side of the point estimate)

```{r}
# get n
ss.aipe.smd(delta = .5, conf.level = .95, width = .6)
# set n
sen_two_group <- ss.aipe.smd.sensitivity(true.delta = .5,
                                         conf.level=.95,
                                         selected.n = 100, print.iter = F)
sen_two_group$Summary
```

# Comparing multiple groups (ANOVA contrasts)

For true.psi = population standardized contrast (lambda = 0.25 low medium effect)
For conf.level = confidence interval 
Return value = total width (half either side of the point estimate)

Five out of five groups of interest
```{r}
# group_5
# get n
ss.aipe.sc(psi = .25, c.weights=c(-0.25, -0.25, -0.25, -0.25, 1), conf.level = .95, width = .45)
# set n
sen_five_group <- ss.aipe.sc.sensitivity(true.psi=0.25,
                                         c.weights=c(-0.25, -0.25, -0.25, -0.25, 1),
                                         selected.n = 100, print.iter = F)
sen_five_group$Summary
```

Four out of five groups of interest
```{r}
# group_5
# get n
ss.aipe.sc(psi = .25, c.weights=c(-0.5, -0.5, 0.5, 0.5, 0), conf.level = .95, width = .45)
# set n
sen_five_group <- ss.aipe.sc.sensitivity(true.psi=0.25,
                                         c.weights=c(-0.5, -0.5, 0.5, 0.5, 0),
                                         selected.n = 100, print.iter = F)
sen_five_group$Summary
```

Three out of five groups of interest
```{r}
# group_5
# get n
ss.aipe.sc(psi = .25, c.weights=c(-0.5, -0.5, 1, 0, 0), conf.level = .95, width = .45)
# set n
sen_five_group <- ss.aipe.sc.sensitivity(true.psi=0.25,
                                         c.weights=c(-0.5, -0.5, 1, 0, 0),
                                         selected.n = 100, print.iter = F)
sen_five_group$Summary
```

Two out of five groups of interest
```{r}
# group_5
# get n
ss.aipe.sc(psi = .25, c.weights=c(-1, 1, 0, 0, 0), conf.level = .95, width = .45)
# set n
sen_twooffive_group <- ss.aipe.sc.sensitivity(true.psi=0.25,
                                         c.weights=c(-1, 1, 0, 0, 0),
                                         selected.n = 100, print.iter = F)
sen_twooffive_group$Summary
```




